<!DOCtYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="module/gl-matrix.js" ></script>
        <title>Canvas Test</title>
    </head>
    <body>
        <style>
            #myCanvas {
                height: 100%;
                width: 100%;
                border: 1px solid gray;
                border-radius: 10px;
                overflow: hidden;
            }
        </style>
        <canvas id="myCanvas" width="1000" height="1000"></canvas>
    </body>

    <script>
        let myCanvas = document.getElementById('myCanvas');
        let gl = myCanvas.getContext("webgl");
        const backColor = [1,1,1,1];

        var vertexShaderCode = `
            precision mediump float;

            attribute vec3 vertPosition;
            attribute vec3 vertColor;
            varying vec3 fragColor;

            uniform mat4 matCube;
            uniform mat4 matView;
            uniform mat4 matProj;
        
            void main() {
                fragColor = vertColor;
                gl_Position = matProj * matView * matCube * vec4(vertPosition, 1.0);
                gl_PointSize = 5.0;
            }
        `;

        var fragmentShaderCode = `
            precision mediump float;
            varying vec3 fragColor;

            void main() {
                gl_FragColor = vec4(fragColor, 1.0);
            }
        `;

        var vertexShader = gl.createShader(gl.VERTEX_SHADER);
        gl.shaderSource(vertexShader, vertexShaderCode);
        gl.compileShader(vertexShader);

        var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
        gl.shaderSource(fragmentShader, fragmentShaderCode);
        gl.compileShader(fragmentShader);

        var program = gl.createProgram();
        gl.attachShader(program, vertexShader);
        gl.attachShader(program, fragmentShader);
        gl.linkProgram(program);
        gl.useProgram(program);

        gl.clearColor(...backColor);
        gl.clear( gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT );
        // gl.drawArrays(gl.POINT, 0, 1);

        var boxVertices = [1.0630276,1.2082936,-0.1166256,0.9678532000000001,0.1810384,-0.1166256,1.0630276,1.2082936,0.1166256,0.9678532000000001,0.1810384,0.1166256,0.6733212000000001,1.20282,-0.1166256,0.5617524000000002,0.0671688,-0.1166256,0.6733212000000001,1.20282,0.1166256,0.5617524000000002,0.0671688,0.1166256,0.7203852000000001,-0.22133280000000002,-0.1166256,0.7203852000000001,-0.22133280000000002,0.1166256,0.971738,0.0507624,-0.1166256,0.971738,0.0507624,0.1166256,0.9783252000000001,-0.3864272,-0.1166256,0.9783252000000001,-0.3864272,0.1166256,1.0589748,-0.08049039999999999,-0.1166256,1.0589748,-0.08049039999999999,0.1166256,1.3180604,-0.42211360000000003,-0.1166256,1.3180604,-0.42211360000000003,0.1166256,1.2771628,-0.10087280000000001,-0.1166256,1.2771628,-0.10087280000000001,0.1166256,1.6507060000000002,-0.1686224,-0.1166256,1.6507060000000002,-0.1686224,0.1166256,1.4352756,-0.004988,-0.1166256,1.4352764,-0.004988,0.1166256,1.7089004000000003,0.082204,-0.1166256,1.7089004000000003,0.082204,0.1166256,1.4745572,0.12245120000000001,-0.1166256,1.4745572,0.122452,0.1166256,1.5537940000000001,0.323164,-0.046328799999999996,1.5537940000000001,0.323164,0.046328799999999996,1.4534948,0.2554672,-0.046328799999999996,1.4534948,0.255468,0.046328799999999996,1.3883892,0.46386000000000005,-0.0116216,1.3883892,0.46386000000000005,0.0116216,1.366722,0.4426016,-0.0116216,1.366722,0.4426016,0.0116216,0.9754004000000001,0.9493264,-0.1166256,0.6454036000000001,0.924132,0.1166256,0.9754004000000001,0.9493264,0.1166256,0.6454036000000001,0.924132,-0.1166256,1.2646332,1.0531928000000002,-0.1166256,1.2646332,1.0531928000000002,0.1166256,1.1481404000000002,0.7807248,-0.1165128,1.1481404000000002,0.7807248,0.1167376,1.4235036,0.9783984,-0.1166256,1.4235036,0.9783984,0.1166256,1.4678140000000002,0.761748,-0.1165128,1.4678140000000002,0.761748,0.1167376,1.5759508,1.0717152,-0.1166256,1.5759508,1.0717152,0.1166256,1.7744572,0.8782135999999999,-0.1165128,1.7744572,0.8782135999999999,0.1167376,1.6003707999999999,1.2494752,-0.1166256,1.6003707999999999,1.2494752,0.1166256,1.9188364,1.1394776,-0.1165128,1.9188364,1.1394776,0.1167376,1.5366764,1.500748,-0.1166256,1.5366764,1.500748,0.1166256,1.8258932,1.4160072,-0.1165128,1.8258932,1.4160072,0.1167376,1.826966,1.53592,-0.1165128,1.826966,1.5359208,0.1167376,2.4787644,1.78688,-0.0219968,2.4787644,1.78688,0.0219968,1.9479212000000001,1.5159976,-0.1165128,1.9479220000000002,1.5159976,0.1167376,0.7059892000000001,1.4678976000000001,0.1166256,0.7059892000000001,1.4678976000000001,-0.1166256,0.5709492,1.5371368,0.1166256,0.5709492,1.5371368,-0.1166256,0.7961044000000002,1.7847624,0.1166256,0.519922,1.63198,0.1166256,0.67803,1.7915184,0.1166256,0.5769404,1.735596,0.1166256,0.519922,1.63198,-0.1166256,0.7961044000000002,1.7847624,-0.1166256,0.5769404,1.735596,-0.1166256,0.67803,1.7915184,-0.1166256,1.1055348,0.6738424000000001,-0.09936880000000001,1.1055348,0.6756216,-0.0760088,1.0848044000000001,0.6516696,-0.09936880000000001,1.0848044000000001,0.6534487999999999,-0.0760088,0.9137572,0.8855848,-0.20796640000000002,0.9137572,0.8855848,-0.1847232,0.8913108000000001,0.8669096,-0.2084552,0.8913108000000001,0.8669096,-0.185212,0.5984340000000001,1.2454832,-0.1970816,0.5984340000000001,1.2404168,-0.1657312,0.5761892000000002,1.2248296,-0.1970816,0.5761892000000002,1.2197624,-0.1657312,0.41660280000000005,1.4357848,-0.14083600000000002,0.41660280000000005,1.4357848,-0.1150592,0.3990172,1.4110432,-0.14083600000000002,0.3990172,1.4110432,-0.1150592,0.19587000000000004,1.5836424,-0.07735600000000001,0.19916200000000012,1.589188,0.0208336,0.1554404000000001,1.4946992,-0.07735600000000001,0.22875960000000006,1.4946992,0.0374056,-0.0150307999999999,1.7196088,-0.0960744,-0.0150307999999999,1.7196088,0.0960752,0.028307600000000033,1.5241136,-0.0960744,0.028307600000000033,1.5241136,0.0960752,-0.25902199999999986,1.6773008,-0.0960744,-0.25902199999999986,1.6773008,0.0960752,-0.11550999999999992,1.4930776,-0.0960744,-0.11550999999999992,1.4930776,0.0960752,-0.3891916,1.446588,-0.0960744,-0.3891916,1.446588,0.0960752,-0.20298359999999996,1.2778544,-0.0960744,-0.20298359999999996,1.2778544,0.0960752,-0.5449307999999998,0.1341848,-0.0960744,-0.5449307999999998,0.1341848,0.0960744,-0.2152132,0.1357136,-0.0960744,-0.2152132,0.1357136,0.0960744,-0.5930371999999998,-0.2356808,-0.0960752,-0.5930371999999998,-0.2356808,0.0960744,-0.15320919999999988,-0.2369208,-0.0960744,-0.15320919999999988,-0.2369208,0.0960744,-0.20536199999999988,1.0557463999999999,0.0960752,-0.20536199999999988,1.0557463999999999,-0.0960744,-0.5207516,1.04904,-0.0960744,-0.5207516,1.04904,0.0960752,-0.5411315999999999,1.3041551999999998,-0.0960744,-0.5411315999999999,1.3041551999999998,0.0960752,-1.0596244,1.5323639999999998,-0.0960744,-1.0596244,1.5323639999999998,0.0960752,-0.7869612,1.3879047999999998,-0.0960744,-0.7869612,1.3879047999999998,0.0960752,-0.8703123999999999,1.2281208,-0.0960744,-0.8703123999999999,1.2281208,0.0960752,-1.2278996,1.0243328,-0.0960744,-1.2278996,1.0243328,0.0960752,-0.8913716,1.0032688,-0.0960744,-0.8913716,1.0032688,0.0960752,-1.2383844,0.6936768,-0.0960744,-1.2383844,0.6936768,0.0960752,-0.9019012,0.68772,-0.0960744,-0.9019012,0.68772,0.0960752,-1.2807036,-0.2385512,-0.0960744,-1.2807036,-0.2385512,0.0960744,-0.9068643999999999,-0.23986239999999998,-0.0960744,-0.9068643999999999,-0.23986239999999998,0.0960744,-1.4097131999999999,1.3610304,-0.0960744,-1.4097131999999999,1.3610304,0.0960752,-1.9711364,0.9256208000000001,-0.0960744,-1.9711364,0.9256208000000001,0.0960752,-1.6401852,0.9181016,-0.0960744,-1.6401852,0.9181016,0.0960752,-1.8660836,0.3568912,-0.0960744,-1.8660836,0.3568912,0.0960744,-1.51933,0.4308376,-0.0960744,-1.51933,0.4308376,0.0960744,-1.86721,0.1748728,-0.0960744,-1.86721,0.1748728,0.0960744,-1.5812468,-0.012334399999999999,-0.0960744,-1.5812468,-0.012334399999999999,0.0960744,-1.9620788,0.0937248,-0.0960744,-1.9620788,0.0937248,0.0960744,-1.8751507999999997,-0.2621688,-0.0960744,-1.8751507999999997,-0.2621688,0.0960744,-2.06555,0.0973936,-0.0960744,-2.06555,0.0973936,0.0960744,-2.2655284,-0.22380879999999997,-0.0960744,-2.2655284,-0.22380879999999997,0.0960744,-2.0992387999999997,0.1937864,-0.0960744,-2.0992387999999997,0.1937864,0.0960744,-2.4787644,0.0107808,-0.0960744,-2.4787644,0.0107808,0.0960744,-2.0150316,0.2362336,-0.0960744,-2.0150316,0.2362336,0.0960744,-2.36333,0.2888096,-0.0960744,-2.36333,0.2888096,0.0960744,-0.9173003999999999,1.6625679999999998,-0.0960744,-0.6346724,1.7206607999999999,-0.0960744,-0.7446012,1.6151792,-0.0960744,-0.8340588,1.7118639999999998,-0.0960744,-0.7306092,1.7331271999999998,-0.0960744,-0.6346724,1.7206607999999999,0.0960752,-0.9173003999999999,1.6625679999999998,0.0960752,-0.7446012,1.6151792,0.0960752,-0.7306092,1.7331271999999998,0.0960752,-0.8340588,1.7118639999999998,0.0960752,-0.6071683999999999,1.7110703999999999,-0.0960744,-0.4122347999999999,1.5144968,-0.0960744,-0.5192843999999999,1.5174864,-0.0960744,-0.5278179999999999,1.666172,-0.0960744,-0.45646679999999995,1.5942216,-0.0960744,-0.4122347999999999,1.5144968,0.0960752,-0.6071683999999999,1.7110703999999999,0.0960752,-0.5192843999999999,1.5174864,0.0960752,-0.45646679999999995,1.5942216,0.0960752,-0.5278179999999999,1.666172,0.0960752,-1.7460964,1.6007672,-0.0960744,-1.1805628,1.5896968,-0.0960744,-1.4174084,1.4154472,-0.0960744,-1.6155979999999999,1.6372632,-0.0960744,-1.4622972,1.6479752,-0.0960744,-1.3095332,1.6312719999999998,-0.0960744,-1.1805628,1.5896968,0.0960752,-1.7460964,1.6007672,0.0960752,-1.4174084,1.4154472,0.0960752,-1.3095332,1.6312719999999998,0.0960752,-1.4622972,1.6479752,0.0960752,-1.6155979999999999,1.6372632,0.0960752,-1.92827,1.367736,-0.0960744,-1.7629236,1.5935831999999999,-0.0960744,-1.7865444,1.4267623999999999,-0.0960744,-1.8733364,1.5009679999999999,-0.0960744,-1.7629236,1.5935831999999999,0.0960752,-1.92827,1.367736,0.0960752,-1.7865444,1.4267623999999999,0.0960752,-1.8733364,1.5009679999999999,0.0960752,-1.5466172,1.352032,-0.0960744,-1.6629412,1.21798,-0.0960744,-1.7744771999999998,1.4179808,-0.0960744,-1.6082724,1.331044,-0.0960744,-1.6508499999999997,1.2819775999999998,-0.0960744,-1.6629412,1.21798,0.0960752,-1.5466172,1.352032,0.0960752,-1.7744771999999998,1.4179808,0.0960752,-1.6508499999999997,1.2819775999999998,0.0960752,-1.6082724,1.331044,0.0960752,-0.6109316,1.392004,-0.0960744,-0.7868883999999998,1.3879744,-0.0960744,-0.7353419999999999,1.584624,-0.0960744,-0.6673819999999999,1.4201872,-0.0960744,-0.7317876,1.4187128,-0.0960744,-0.7868883999999998,1.3879744,0.0960752,-0.6109316,1.392004,0.0960752,-0.7353419999999999,1.584624,0.0960752,-0.7317876,1.4187128,0.0960752,-0.6673819999999999,1.4201872,0.0960752,-1.2270252,1.2140464,-0.0960744,-1.3242564,1.3394616,-0.0960744,-1.1652228,1.3947432,-0.0960744,-1.1286580000000002,1.2909824,-0.0960744,-1.2398820000000002,1.2677288,-0.0960744,-1.2754708000000001,1.3136344,-0.0960744,-1.3242564,1.3394616,0.0960752,-1.2270252,1.2140464,0.0960752,-1.1286580000000002,1.2909824,0.0960752,-1.1652228,1.3947432,0.0960752,-1.2754708000000001,1.3136344,0.0960752,-1.2398820000000002,1.2677288,0.0960752,1.0292636000000002,1.5223032,0.1166256,0.8265515999999999,1.7745384000000002,0.1166256,0.8594572000000001,1.5923376,0.1166256,0.994586,1.6260304,0.1166256,0.9203884,1.7183552,0.1166256,0.8265515999999999,1.7745384000000002,-0.1166256,1.0292636000000002,1.5223032,-0.1166256,0.8594572000000001,1.5923376,-0.1166256,0.9203884,1.7183552,-0.1166256,0.994586,1.6260304,-0.1166256,1.5834892,1.6167288,-0.1166256,1.8479348000000002,1.7932336,-0.0945072,1.761662,1.6346664,-0.11655599999999999,1.6256996000000001,1.6848680000000003,-0.1149416,1.6907772,1.7423392,-0.1101472,1.7688164,1.7803920000000002,-0.1029712,1.8479348000000002,1.7932336,0.09450800000000001,1.58349,1.6167288,0.1166256,1.761662,1.6346664,0.1166952,1.7688156,1.7803920000000002,0.102972,1.6907772,1.7423392,0.1101472,1.6256996000000001,1.6848680000000003,0.1149416];

        for(i = 3; i < boxVertices.length; i += 6) {
            boxVertices.splice(i, 0, Math.random(), Math.random(), Math.random());
        }
	    var boxIndices = [38,6,37,6,39,37,7,11,3,2,40,0,4,36,39,11,14,10,5,9,7,1,11,10,5,10,8,13,19,15,8,14,12,9,15,11,8,13,9,19,21,23,12,17,13,15,18,14,12,18,16,23,26,22,16,21,17,19,22,18,18,20,16,27,29,31,22,24,20,23,25,27,20,25,21,28,33,29,24,29,25,27,30,26,26,28,24,32,79,33,31,34,30,30,32,28,31,33,35,39,1,5,36,3,1,37,5,7,3,37,7,43,45,41,38,42,43,38,41,2,36,40,42,47,49,45,41,44,40,43,46,47,42,44,46,49,55,53,44,49,48,47,50,51,46,48,50,55,58,59,49,52,48,51,54,55,48,54,50,57,254,56,52,58,54,53,59,57,53,56,52,65,260,61,255,62,64,59,60,61,64,63,65,254,256,60,61,64,65,61,262,261,249,70,245,6,67,4,251,69,77,2,250,244,67,251,250,67,68,69,74,68,71,74,73,76,76,72,77,77,70,75,244,246,66,78,84,82,34,81,80,34,78,32,35,79,81,85,87,89,79,85,81,78,83,79,80,85,84,89,92,88,82,87,83,84,89,88,82,88,86,91,97,93,86,92,90,87,93,89,87,90,91,95,98,99,91,94,95,93,96,92,92,94,90,101,104,100,96,101,100,94,100,98,95,101,97,104,106,102,98,104,102,99,105,101,98,103,99,118,112,119,105,107,109,102,107,103,104,109,108,112,114,110,120,112,110,121,113,118,120,111,121,116,115,114,113,115,117,110,115,111,112,117,116,109,121,118,108,120,106,109,119,108,223,126,172,178,125,127,121,122,120,229,228,189,107,189,123,222,224,184,126,129,128,106,187,107,123,222,122,122,184,106,125,240,129,198,200,241,235,132,130,133,135,137,194,193,234,128,133,132,235,124,128,135,141,137,130,135,131,132,137,136,132,134,130,139,140,141,134,139,135,136,141,140,134,140,138,240,131,133,204,145,209,213,146,144,238,142,233,124,198,125,147,149,151,208,210,219,209,145,217,142,218,212,150,155,154,146,151,150,146,148,144,144,149,145,154,156,152,150,152,148,148,153,149,151,153,155,159,161,163,153,156,157,155,157,159,155,158,154,160,166,164,159,162,158,158,160,156,156,161,157,164,170,168,161,164,165,161,167,163,163,166,162,169,170,171,165,168,169,165,171,167,167,170,166,172,175,174,175,176,174,176,173,174,177,180,179,180,181,179,181,178,179,178,175,172,175,180,176,176,177,173,172,125,178,182,185,184,185,186,184,186,183,184,187,190,189,190,191,189,191,188,189,182,191,185,185,190,186,186,187,183,188,173,177,192,195,194,195,196,194,196,197,194,197,193,194,198,201,200,201,202,200,202,203,200,203,199,200,199,195,192,203,196,195,202,197,196,201,193,197,214,206,205,204,207,206,207,205,206,208,211,210,211,209,210,209,207,204,211,205,207,192,208,199,212,215,214,215,216,214,216,213,214,217,220,219,220,221,219,221,218,219,212,221,215,215,220,216,216,217,213,217,146,213,222,225,224,225,226,224,226,223,224,227,230,229,230,231,229,231,228,229,228,225,222,231,226,225,230,223,226,227,126,223,236,237,234,243,240,241,239,236,232,243,237,236,242,233,237,232,131,239,244,247,246,247,248,246,248,245,246,249,252,251,252,253,251,253,250,251,245,252,249,248,253,252,247,250,253,73,71,68,254,257,256,257,258,256,258,259,256,259,255,256,260,263,262,263,264,262,264,265,262,265,261,262,261,257,254,257,264,258,258,263,259,259,260,255,260,62,255,38,2,6,6,4,39,7,9,11,2,41,40,4,0,36,11,15,14,5,8,9,1,3,11,5,1,10,13,17,19,8,10,14,9,13,15,8,12,13,19,17,21,12,16,17,15,19,18,12,14,18,23,27,26,16,20,21,19,23,22,18,22,20,27,25,29,22,26,24,23,21,25,20,24,25,28,32,33,24,28,29,27,31,30,26,30,28,32,78,79,31,35,34,30,34,32,31,29,33,39,36,1,36,38,3,37,39,5,3,38,37,43,47,45,38,36,42,38,43,41,36,0,40,47,51,49,41,45,44,43,42,46,42,40,44,49,51,55,44,45,49,47,46,50,46,44,48,55,54,58,49,53,52,51,50,54,48,52,54,57,261,254,52,56,58,53,55,59,53,57,56,63,260,65,260,262,61,64,60,255,60,256,255,59,58,60,64,62,63,60,58,56,56,254,60,61,60,64,261,57,61,57,59,61,249,75,70,6,66,67,75,249,251,251,67,69,69,74,76,76,77,69,77,75,251,2,0,250,250,0,67,0,4,67,67,66,68,74,69,68,74,71,73,76,73,72,77,72,70,66,6,2,2,244,66,78,80,84,34,35,81,34,80,78,35,33,79,85,83,87,79,83,85,78,82,83,80,81,85,89,93,92,82,86,87,84,85,89,82,84,88,91,95,97,86,88,92,87,91,93,87,86,90,95,94,98,91,90,94,93,97,96,92,96,94,101,105,104,96,97,101,94,96,100,95,99,101,104,108,106,98,100,104,99,103,105,98,102,103,118,113,112,105,103,107,102,106,107,104,105,109,112,116,114,120,119,112,121,111,113,120,110,111,116,117,115,113,111,115,110,114,115,112,113,117,109,107,121,108,119,120,109,118,119,124,172,126,172,174,224,223,172,224,127,227,178,227,229,178,229,179,178,121,123,122,228,123,189,189,188,229,188,177,179,229,188,179,123,121,107,107,187,189,173,182,174,182,184,224,174,182,224,184,122,222,126,127,129,106,183,187,123,228,222,183,106,184,106,120,122,129,127,125,125,241,240,143,238,200,238,241,200,241,125,198,130,232,235,235,128,132,133,131,135,193,124,234,234,233,194,233,142,194,128,129,133,234,124,235,124,126,128,135,139,141,130,134,135,132,133,137,132,136,134,139,138,140,134,138,139,136,137,141,134,136,140,133,129,240,240,239,131,204,144,145,144,204,213,204,206,214,213,204,214,238,143,142,124,193,198,147,145,149,218,143,200,200,199,218,199,208,219,218,199,219,147,217,145,217,219,209,219,210,209,142,143,218,150,151,155,146,147,151,146,150,148,144,148,149,154,158,156,150,154,152,148,152,153,151,149,153,159,157,161,153,152,156,155,153,157,155,159,158,160,162,166,159,163,162,158,162,160,156,160,161,164,166,170,161,160,164,161,165,167,163,167,166,169,168,170,165,164,168,165,169,171,167,171,170,178,181,175,175,181,180,176,180,177,172,124,125,182,188,191,185,191,190,186,190,187,188,182,173,199,203,195,203,202,196,202,201,197,201,198,193,205,192,214,192,194,212,194,142,212,212,214,192,209,211,207,211,208,205,192,205,208,212,218,221,215,221,220,216,220,217,217,147,146,228,231,225,231,230,226,230,227,223,227,127,126,235,232,236,237,233,234,235,236,234,241,238,242,243,239,240,241,242,243,239,243,236,243,242,237,242,238,233,232,130,131,245,248,252,248,247,253,247,244,250,68,66,246,246,245,70,70,72,246,72,73,68,246,72,68,261,265,257,257,265,264,258,264,263,259,263,260,260,63,62];

        var boxVertexBufferObject = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, boxVertexBufferObject);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(boxVertices), gl.STATIC_DRAW);

        var boxIndexBufferObject = gl.createBuffer();
        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, boxIndexBufferObject);
        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(boxIndices), gl.STATIC_DRAW);

        var positionAttribLocation = gl.getAttribLocation(program, 'vertPosition');
        var colorAttribLocation = gl.getAttribLocation(program, 'vertColor');

        var matCubeUniformLocation = gl.getUniformLocation(program, 'matCube');
        var matViewUniformLocation = gl.getUniformLocation(program, 'matView');
        var matProjUniformLocation = gl.getUniformLocation(program, 'matProj');

        gl.vertexAttribPointer(
            positionAttribLocation,
            3,
            gl.FLOAT,
            gl.FALSE,
            6 * Float32Array.BYTES_PER_ELEMENT,
            0
        );
        gl.vertexAttribPointer(
            colorAttribLocation,
            3,
            gl.FLOAT,
            gl.FALSE,
            6 * Float32Array.BYTES_PER_ELEMENT,
            3 * Float32Array.BYTES_PER_ELEMENT
        );

        gl.enableVertexAttribArray(positionAttribLocation);
        gl.enableVertexAttribArray(colorAttribLocation);
        gl.enable(gl.DEPTH_TEST);
        gl.useProgram(program);

        var matCube = new Float32Array(16);
        mat4.identity(matCube);

        var matView = new Float32Array(16);
        mat4.lookAt(matView, [0, 0, -7], [0, 0, 0], [0, 1, 0]);

        var matProj = new Float32Array(16);
        mat4.perspective(matProj, glMatrix.toRadian(45), myCanvas.width/myCanvas.height, 0.1, 1000.0);

        gl.uniformMatrix4fv(matCubeUniformLocation, gl.FALSE, matCube);
        gl.uniformMatrix4fv(matViewUniformLocation, gl.FALSE, matView);
        gl.uniformMatrix4fv(matProjUniformLocation, gl.FALSE, matProj);
        

        var identityMatrix = new Float32Array(16);
        var xRotMat = new Float32Array(16);
        var yRotMat = new Float32Array(16);
        mat4.identity(identityMatrix);
        
        gl.clearColor(...backColor);
        gl.clear( gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT );
        gl.drawElements(gl.TRIANGLES, boxIndices.length, gl.UNSIGNED_SHORT, 0);

        function covertNormalToGlCoordinate(coordinate) {
            return {
                x: (coordinate.x - (myCanvas.offsetHeight/2))/myCanvas.offsetHeight,
                y: (coordinate.y - (myCanvas.offsetWidth/2))/myCanvas.offsetWidth 
            }
        }

        let tempMouseLocation = {x: 0, y: 0};
        let angleMat = {x: 0, y: 0};
        let velocity = {x: 0, y: 0};
        const clickGetLocation = (e) => {
            e.preventDefault();
            if(dragged) {
                let location = {
                    x: e.pageX - myCanvas.offsetTop, 
                    y: e.pageY - myCanvas.offsetLeft
                };
                
                velocity = {
                    x: location.x - tempMouseLocation.x, 
                    y: tempMouseLocation.y - location.y 
                };

                tempMouseLocation = location;

                angleMat.x += velocity.x;
                angleMat.y += velocity.y;

                mat4.rotate(xRotMat, identityMatrix, angleMat.x/150 , [0, 1, 0]);
                mat4.rotate(yRotMat, identityMatrix, angleMat.y/150 , [1, 0, 0]);
                mat4.mul(matCube, xRotMat, yRotMat);
                gl.uniformMatrix4fv(matCubeUniformLocation, gl.FALSE, matCube);

                gl.clearColor(...backColor);
                gl.clear( gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT );
                gl.drawElements(gl.TRIANGLES, boxIndices.length, gl.UNSIGNED_SHORT, 0);
            }
        }

        const DECELERATION_RATE = 1.5;

        function decelerate(v, a) {
            var base = (v < 0)?-1:1;
            var res = Math.abs(v) - a;
            return base * ((res<0)?0:res);
        }

        var loop = () => {
            angleMat.x += velocity.x;
            angleMat.y += velocity.y;
            console.log("loop", velocity);

            velocity.x = decelerate(velocity.x, DECELERATION_RATE);
            velocity.y = decelerate(velocity.y, DECELERATION_RATE);

            mat4.rotate(xRotMat, identityMatrix, angleMat.x/150, [0, 1, 0]);
            mat4.rotate(yRotMat, identityMatrix, angleMat.y/150, [1, 0, 0]);
            mat4.mul(matCube, xRotMat, yRotMat);
            gl.uniformMatrix4fv(matCubeUniformLocation, gl.FALSE, matCube);

            gl.clearColor(...backColor);
            gl.clear( gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT );
            gl.drawElements(gl.TRIANGLES, boxIndices.length, gl.UNSIGNED_SHORT, 0);

            if(Math.abs(velocity.x) > 0 || Math.abs(velocity.y) > 0) 
                requestAnimationFrame(loop);
        };

        myCanvas.onmousemove = clickGetLocation;
        let dragged = false;
        myCanvas.onmousedown = (e) => {
            dragged = true; 
            tempMouseLocation = {
                x: e.pageX - myCanvas.offsetTop, 
                y: e.pageY - myCanvas.offsetLeft
            };
        }
        myCanvas.onmouseup = () => {
            dragged = false;
            loop();
        }

    </script>
</html>